(function(){"use strict";var __webpack_modules__={9132:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var vue__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3396),vue__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(7139),vue__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(4870),_components_Icon_vue__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3449);const _hoisted_1={class:"box"},_hoisted_2={class:"card"},_hoisted_3=(0,vue__WEBPACK_IMPORTED_MODULE_0__.Uk)("控制面板 "),_hoisted_4=(0,vue__WEBPACK_IMPORTED_MODULE_0__.Uk)("从OneDrive选择文件 "),_hoisted_5=(0,vue__WEBPACK_IMPORTED_MODULE_0__.Uk)("额外创建分享链接（配合1drv.ws使用） "),_hoisted_6={class:"mask"},_hoisted_7=["onClick"],_hoisted_8={class:"mask"},_hoisted_9={class:"card out"},_hoisted_10=(0,vue__WEBPACK_IMPORTED_MODULE_0__.Uk)("输出面板 "),_hoisted_11={class:"tip"},_hoisted_12={class:"mask"},_hoisted_13=(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("div",{class:"copyright"},[(0,vue__WEBPACK_IMPORTED_MODULE_0__.Uk)(" Copyright © 2017 "),(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("a",{href:"https://github.com/Mapaler/GetOneDriveDirectLink",target:"_blank"},"枫谷剑仙"),(0,vue__WEBPACK_IMPORTED_MODULE_0__.Uk)(" 版权所有，本程序源代码使用GPLv3协议公开 "),(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("br"),(0,vue__WEBPACK_IMPORTED_MODULE_0__.Uk)("Mapaler all right reserved. Source public by GPLv3. "),(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("div",{class:"hr"}),(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("p",null,[(0,vue__WEBPACK_IMPORTED_MODULE_0__.Uk)(" 使用 Vue3 进行二次开发与美化 by 2022 "),(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("a",{href:"https://github.com/SpectreGao/GetOneDriveDirectLink_Code",target:"_blank"},"SpectreGao"),(0,vue__WEBPACK_IMPORTED_MODULE_0__.Uk)("，如有侵权，将第一时间删除 ")])],-1);__webpack_exports__["Z"]={__name:"App",setup(__props){const selectIndex=(0,vue__WEBPACK_IMPORTED_MODULE_2__.iH)(0),msg=(0,vue__WEBPACK_IMPORTED_MODULE_2__.iH)("点击按钮从OneDrive选择文件"),result=(0,vue__WEBPACK_IMPORTED_MODULE_2__.iH)("文件的url直链在此显示"),redata=(0,vue__WEBPACK_IMPORTED_MODULE_2__.iH)(null),launchOneDrivePicker=(_="query")=>{if("query"==_){msg.value="正在等待API返回数据";let e={clientId:"5712d2c8-2c32-4f4f-a5aa-fdc966092171",action:_,multiSelect:!0,openInNewWindow:!0,advanced:{queryParameters:"select=audio,content,createdBy,createdDateTime,cTag,deleted,description,eTag,file,fileSystemInfo,folder,id,image,lastModifiedBy,lastModifiedDateTime,location,malware,name,package,parentReference,photo,publication,remoteItem,root,searchResult,shared,sharepointIds,size,specialFolder,video,webDavUrl,webUrl,activities,children,listItem,permissions,thumbnails,versions,@microsoft.graph.conflictBehavior,@microsoft.graph.downloadUrl,@microsoft.graph.sourceUrl"},success:function(_){redata.value=_,console.log("本次返回 %d 个文件，数据为 %o",redata.value.value.length,redata.value),generate_output(redata.value)},cancel:()=>{msg.value="取消操作"},error:function(_){msg.value="发生错误",result.value=_.toString()}};OneDrive.open(e)}},generate_output=_=>{let e=maskCfg[selectIndex.value],i=_.value;msg.value="共选择 "+i.length+" 个文件。",i.some((function(_){return void 0==_.shared||"anonymous"!=_.shared.scope}))&&(msg.value+="存在非公共权限文件，注意添加通行许可代码。");let t=i.map((function(_,i){let t=showMask(e.cfg,_,i);return t}));result.value=t.join("\n")},showMask=(str,file,index)=>{var newTxt=eval("`"+str+"`"),pattern="%{([^}]+)}",rs=null;while(null!=(rs=new RegExp(pattern).exec(newTxt))){var mskO=rs[0],mskN=rs[1];if(void 0!=mskN){mskN=void 0!=mskN?mskN.replace(/\\{/gi,"{").replace(/\\}/gi,"}").replace(/\\\\/gi,"\\"):null;try{var evTemp=eval(mskN);newTxt=void 0!=evTemp?newTxt.replace(mskO,evTemp.toString()):newTxt.replace(mskO,"")}catch(e){msg.value="掩码异常，详情查看控制台",console.error(mskO+" 掩码出现了异常情况",e)}}}return newTxt},selectChange=_=>{selectIndex.value=_,redata.value&&generate_output(redata.value)},maskCfg=[{name:"普通外链",cfg:"http://storage.live.com/items/${file.id}:/${file.name}"},{name:"最短链接",cfg:"http://storage.live.com/items/${file.id}"},{name:"UBB代码外链图片",cfg:"[img]http://storage.live.com/items/${file.id}:/${file.name}[/img]"},{name:"模板字符串基本使用示例",cfg:"在OneDrive里查看 ${file.name} 的地址是：${file.webUrl}"},{name:"表达式使用示例",cfg:'${index+1}号文件的尺寸是：${file.size>1024?Math.round(file.size/1024)+"K":file.size}B'},{name:"自动选择img/mp3 UBB代码",cfg:'[${file.image?"img":(file.audio?"mp3":"file")}]http://storage.live.com/items/${file.id}:/${file.name}[/${file.image?"img":(file.audio?"mp3":"file")}]'},{name:"ES6完整文件尺寸换算示例",cfg:'${index+1}号文件的尺寸是：${(function(size){const bArr = ["B","KiB","MiB","GiB","TiB"];for(let idx=0;idx<bArr.length;idx++){if(idx<bArr.length && size/Math.pow(1024,idx+1)>1)continue;else return (size/Math.pow(1024,idx)).toFixed(2) + " " + bArr[idx];}})(file.size)}'},{name:"ES6闭包函数示例1",cfg:'文件的权限是：${(scope=>{switch(scope){case "anonymous":return "所有人";case "users":return "仅限指定用户";default:return "私有";}})(file.shared?file.shared.scope:null)}'},{name:"ES6闭包函数示例2",cfg:'文件年份：${(createTime=>new Date(createTime).toLocaleString(\'zh-u-ca-chinese-nu-hanidec\',{year:"numeric",month:"long"}))(file.createdDateTime)}'},{name:"官方图片下载直连（短期？）",cfg:'${file["@microsoft.graph.downloadUrl"].replace(/public.w+.files/i,"public.ch.files")}'}];return(0,vue__WEBPACK_IMPORTED_MODULE_0__.bv)((()=>{if("https:"!=location.protocol&&"localhost"!=location.hostname&&""!=location.hostname){var _=confirm("检测到你正在使用http模式，本应用要求使用https模式。\n是否自动跳转？");_&&(location.protocol="https:")}})),(_,e)=>((0,vue__WEBPACK_IMPORTED_MODULE_0__.wg)(),(0,vue__WEBPACK_IMPORTED_MODULE_0__.iD)("div",_hoisted_1,[(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("div",_hoisted_2,[(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("h3",null,[(0,vue__WEBPACK_IMPORTED_MODULE_0__.Wm)(_components_Icon_vue__WEBPACK_IMPORTED_MODULE_1__.Z,{icon:"Microsoft",size:"24",color:"#488ded"}),_hoisted_3]),(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("div",null,[(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("button",{onClick:e[0]||(e[0]=_=>launchOneDrivePicker("query"))},[(0,vue__WEBPACK_IMPORTED_MODULE_0__.Wm)(_components_Icon_vue__WEBPACK_IMPORTED_MODULE_1__.Z,{icon:"Cloud"}),_hoisted_4]),(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("button",{onClick:e[1]||(e[1]=_=>launchOneDrivePicker("share"))},[(0,vue__WEBPACK_IMPORTED_MODULE_0__.Wm)(_components_Icon_vue__WEBPACK_IMPORTED_MODULE_1__.Z,{icon:"Share"}),_hoisted_5])]),(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("ul",_hoisted_6,[((0,vue__WEBPACK_IMPORTED_MODULE_0__.wg)(),(0,vue__WEBPACK_IMPORTED_MODULE_0__.iD)(vue__WEBPACK_IMPORTED_MODULE_0__.HY,null,(0,vue__WEBPACK_IMPORTED_MODULE_0__.Ko)(maskCfg,((_,e)=>(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("li",{key:e,class:(0,vue__WEBPACK_IMPORTED_MODULE_3__.C_)(selectIndex.value==e?"active":""),onClick:_=>selectChange(e)},(0,vue__WEBPACK_IMPORTED_MODULE_3__.zw)(_.name),11,_hoisted_7))),64))]),(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("div",_hoisted_8,[(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("p",null,(0,vue__WEBPACK_IMPORTED_MODULE_3__.zw)(maskCfg[selectIndex.value].cfg),1)])]),(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("div",_hoisted_9,[(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("h3",null,[(0,vue__WEBPACK_IMPORTED_MODULE_0__.Wm)(_components_Icon_vue__WEBPACK_IMPORTED_MODULE_1__.Z,{icon:"Microsoft",size:"24",color:"#488ded"}),_hoisted_10]),(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("div",_hoisted_11,(0,vue__WEBPACK_IMPORTED_MODULE_3__.zw)(msg.value),1),(0,vue__WEBPACK_IMPORTED_MODULE_0__._)("div",_hoisted_12,(0,vue__WEBPACK_IMPORTED_MODULE_3__.zw)(result.value),1),_hoisted_13])]))}}},6230:function(_,e,i){var t=i(9242),r=i(9132);const a=r.Z;var n=a;(0,t.ri)(n).mount("#app")},3449:function(_,e,i){i.d(e,{Z:function(){return c}});var t=i(3396);const r=["width","height","innerHTML","fill"];var a={__name:"Icon",props:{icon:{type:String,default:""},size:{type:String,default:"16"},color:{type:String,default:"#fff"}},setup(_){const e={Microsoft:'<path d="M11.5 3v8.5H3V3h8.5zm0 18H3v-8.5h8.5V21zm1-18H21v8.5h-8.5V3zm8.5 9.5V21h-8.5v-8.5H21z""/>',Cloud:'<path d="M17 21H7A6 6 0 0 1 5.008 9.339a7 7 0 1 1 13.984 0A6 6 0 0 1 17 21zm0-12a5 5 0 1 0-9.994.243l.07 1.488-1.404.494A4.002 4.002 0 0 0 7 19h10a4 4 0 1 0-3.796-5.265l-1.898-.633A6.003 6.003 0 0 1 17 9z"/>',Share:'<path d="M13.12 17.023l-4.199-2.29a4 4 0 1 1 0-5.465l4.2-2.29a4 4 0 1 1 .959 1.755l-4.2 2.29a4.008 4.008 0 0 1 0 1.954l4.199 2.29a4 4 0 1 1-.959 1.755zM6 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm11-6a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm0 12a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/>'};return(i,a)=>((0,t.wg)(),(0,t.iD)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:_.size,height:_.size,innerHTML:e[_.icon],fill:_.color},null,8,r))}},n=i(89);const o=(0,n.Z)(a,[["__scopeId","data-v-553c0b5c"]]);var c=o}},__webpack_module_cache__={};function __webpack_require__(_){var e=__webpack_module_cache__[_];if(void 0!==e)return e.exports;var i=__webpack_module_cache__[_]={exports:{}};return __webpack_modules__[_](i,i.exports,__webpack_require__),i.exports}__webpack_require__.m=__webpack_modules__,function(){var _=[];__webpack_require__.O=function(e,i,t,r){if(!i){var a=1/0;for(u=0;u<_.length;u++){i=_[u][0],t=_[u][1],r=_[u][2];for(var n=!0,o=0;o<i.length;o++)(!1&r||a>=r)&&Object.keys(__webpack_require__.O).every((function(_){return __webpack_require__.O[_](i[o])}))?i.splice(o--,1):(n=!1,r<a&&(a=r));if(n){_.splice(u--,1);var c=t();void 0!==c&&(e=c)}}return e}r=r||0;for(var u=_.length;u>0&&_[u-1][2]>r;u--)_[u]=_[u-1];_[u]=[i,t,r]}}(),function(){__webpack_require__.n=function(_){var e=_&&_.__esModule?function(){return _["default"]}:function(){return _};return __webpack_require__.d(e,{a:e}),e}}(),function(){__webpack_require__.d=function(_,e){for(var i in e)__webpack_require__.o(e,i)&&!__webpack_require__.o(_,i)&&Object.defineProperty(_,i,{enumerable:!0,get:e[i]})}}(),function(){__webpack_require__.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(_){if("object"===typeof window)return window}}()}(),function(){__webpack_require__.o=function(_,e){return Object.prototype.hasOwnProperty.call(_,e)}}(),function(){var _={143:0};__webpack_require__.O.j=function(e){return 0===_[e]};var e=function(e,i){var t,r,a=i[0],n=i[1],o=i[2],c=0;if(a.some((function(e){return 0!==_[e]}))){for(t in n)__webpack_require__.o(n,t)&&(__webpack_require__.m[t]=n[t]);if(o)var u=o(__webpack_require__)}for(e&&e(i);c<a.length;c++)r=a[c],__webpack_require__.o(_,r)&&_[r]&&_[r][0](),_[r]=0;return __webpack_require__.O(u)},i=self["webpackChunkget_onedrive_direct_link"]=self["webpackChunkget_onedrive_direct_link"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var __webpack_exports__=__webpack_require__.O(void 0,[998],(function(){return __webpack_require__(6230)}));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();
//# sourceMappingURL=app.83239f74.js.map